
                <div id="question_<%= $question->{id} %>" class="question<%= $question->{answer} ? 'answered' : 'unanswered' %>container">
                    <div class="questioninfocontainer">
                        <div id="questiontime_<%= $question->{created} %>" class="questiontime">
                            <h4><%= $question->{created} %></h4>
                        </div>
                    </div>
                    <div class="question">
                        <h1 class="questiontitle"><%= $question->{question} %></h1>
                        <div id="<%= $question->{id} %>" class="infobar">
                            <h4 id="showcomments_<%= $question->{id}%>" class="info">Show Comments</h4>
                        </div>
                    </div>
                </div>
                <div id="commentcontainer_<%= $question->{id} %>" class="commentcontainer">
                </div>
                <script>
                    $(document).ready(function(){
                        var shown = false;
                        var loaded = false;
                        $("#showcomments_<%= $question->{id} %>").click(function(){
                            if (shown){
                                $("#commentcontainer_<%= $question->{id} %>").toggle(false);
                                $("#showcomments_<%= $question->{id} %>").html("Show Comments");
                                shown = false;
                            }
                            else {
                                if (!loaded){  //Load comments for question via post request
                                    var HTMLstring = "";
                                    console.log('Loading comment data');
                                    $.get("<%= url_for 'comments', {question_id => $question->{id}} %>", function(data){
                                        console.log('Comment data loaded');
                                        $.each(data, function(i, v){
                                            HTMLstring = HTMLstring + (
                                                "<div id='comment_" + v.comment_id + "' class='comment'>\
                                                <span id='commentvotecount_" + v.comment_id + "' class='commentvotecount'>" + v.votes + "</span><div class='commentvotecontainer'>\
                                                <span id='commenttime_" + v.comment_id + "' class='commenttime' ><h4>" + v.created + "</h4></span><img id='markanswer_" + v.comment_id + "' \
                                                class='markanswerbutton' question_id='" + v.question_id + "' src='/../../img/checkmark.png'>\
                                                <span class='commenttext' id='commenttext_" + v.comment_id + "' question_id='" + v.question_id + "'>\
                                                " + v.comment + "</span></div>");
                                                $("#commentcontainer_<%= $question->{id} %>").html(HTMLstring);
                                                console.log("Checked checkmark for question #" + v.comment_id);
                                                console.log("Comment number " + v.comment_id + " and question number " + v.question_id); 
                                        });
                                    }, 'json');
                                    loaded = true;
                                }
                                shown = true;
                                $("#commentcontainer_<%= $question->{id} %>").toggle(true);
                                $("#showcomments_<%= $question->{id} %>").html("Hide Comments");
                                console.log('Comments displayed');
                            }
                        });
                    });
                </script>
                </div>