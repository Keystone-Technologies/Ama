<html>
<head>

	
	<meta name="google-signin-client_id" content="156728782684-3v8c4suoku9kqcqoe0ghoouahuukqv1m.apps.googleusercontent.com">
	<script src="https://apis.google.com/js/api.js"></script>
	<script src="https://apis.google.com/js/platform.js" async defer></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script src="/js/scripts.js"></script>
	<link rel="stylesheet" media="screen and (max-device-width: 800px)" href="/css/style.css">
	<link rel="stylesheet" media="screen and (min-device-width: 800px)" href="/css/desktop.css">
</head>
<title>Ask Me Anything</title>
<script>
gapi.load('auth2', function() {
		gapi.auth2.init();
	});
</script>
<script>
function ConfirmDelete()
    {
      var x = confirm("Are you sure you want to delete?");
      if (x)
          return true;
      else
        return false;
    }
$(document).ready(function() {
	//extracts html from page and stores it in global variables
	HTMLforPost = $(".singlePost").html();
    $(".singlePost").remove();
    HTMLforComment = $(".singleComment").html();
    $(".singleComment").remove();
    
    //hides all containers that are needed to be hidden
	$(".newQuestionContainer").hide();
	$(".singleComment").remove();
	$(".singlePost").remove();
	$(".sortMenuContainer").hide();
	$(".backgroundCover").hide();
	$(".searchBar").hide();
	
    setCurrentUser("<%=session 'username'%>");
    
    //this is where it should set the last viewed options, something like that with cookies
    changeQuestions();
    
    $(window).resize(function() {
    	resizePosts();
    	for(var i = 0; i < getQuestionCount(); i ++) {
    		if(getQuestion(i).getCommentsShown()) {
    			resizeComments(getQuestion(i).getId());
    		}
    	}
    });
    
    $(window).scroll(function() {
		if(deviceType == "mobile") {
			if($(window).scrollTop() > 500 && $(".newQuestionContainer").css('display') != 'none') {
				$(".padding").css('height','200px');
				$(".filterContainer").css({"position":"fixed", "top":"100"});
			}
			else if($(window).scrollTop() > 100 && $(".newQuestionContainer").css('display') == 'none') {
				$(".padding").css('height','200px');
				$(".filterContainer").css({"position":"fixed", "top":"100"});
			}
			else {
				$(".padding").css('height','100px');
				$(".filterContainer").css({"position":"relative", "top":"0"});
			}
		}
	});
    
});
</script>

<body>
	<div class="header">
		<div class="logoContainer"> 
			<img class="logoImg" src="/img/logo.png" alt="LOGO">
		</div>
		<div class="version">
			v<%=$self->version%>
		</div>
		<div class="youtube">
			<a href="https://www.youtube.com/channel/UCwSuyK7EsrNN02Z92bI34gA/feed" target="_blank">
				<img class="youtubeImg" src="/img/youtubehover.png" alt="YOUTUBE">
			</a>
		</div>
	</div>
	
	<div class="padding"></div>
	
	<div class="newQuestion" onclick="toggleQuestionForm()">
		Ask A Question
	</div>
	
	<div class="newQuestionContainer">
		<br><label for='question' class="newPostTitle">New Question</label><br>
		<textarea placeholder= "Enter question here" class="newPostTextarea" id="newQuestionTextarea" required></textarea><br>
		<button class='postButton' onclick="submitQuestion()">Create </button>
	</div>
	
	<div class="backgroundCover" onclick="closeMenu('none')">
	 
	</div>
	
	<div class="sortMenuContainer">
		<div class="sortMenuTitle">
			Sort Options
		</div>
		
		<div class="sortMenuOptionsContainer">
			<div class="sortMenuOption" id="creator_all" onclick="changeFilter('creator', 'all')">
				all
			</div><div class="sortMenuOption" id="creator_my" onclick="changeFilter('creator', 'my')">
			mine</div>
		</div>
		<div class="sortMenuOptionsContainer">
			<div class="sortMenuOption" id="answered_1" onclick="changeFilter('answered', 1)">
				answered
			</div><div class="sortMenuOption" id="answered_0" onclick="changeFilter('answered', 0)">
			unanswered</div>
		</div>
		
		<div class= "sortMenuTitle">
			votes
		</div>
		
		<div class="sortMenuOptionsContainer">
			<div class="sortMenuOption" id="votes_desc" onclick="changeFilter('orderby', 'votes');changeFilter('direction', 'desc')">
				popular
			</div><div class="sortMenuOption" id="votes_asc" onclick="changeFilter('orderby', 'votes');changeFilter('direction', 'asc')">
			unpopular</div>
		</div>
		
		<div class= "sortMenuTitle">
			date
		</div>
		
		<div class="sortMenuOptionsContainer">
			<div class="sortMenuOption" id="created_asc" onclick="changeFilter('orderby', 'created');changeFilter('direction', 'asc')">
				old
			</div><div class="sortMenuOption" id="created_desc" onclick="changeFilter('orderby', 'created');changeFilter('direction', 'desc')">
			new</div>
		</div>
		
		<div class="sortMenuButton">
			<div class="sortMenuButtonText" onclick="closeMenu('cancel')">
				Cancel
			</div>
		</div><div class="sortMenuButton">
			<div class="sortMenuButtonText" onclick="closeMenu('save');changeQuestions()">
				Apply
			</div>
		</div>
		
	</div>
	
	<div class="filterContainer">
		<div class="sortMenuButtonContainer">
			<img class="containedImg" src="/img/menubutton.png" alt="menu" onclick="showSortMenu()">
		</div>
		<div class="filterName">
			filter
		</div>
		<div class="searchButtonContainer">
			<img class="containedImg" src="/img/searchbutton.png" alt="search" onclick="toggleSearchBar()">
		</div>
	</div>
	
	<div class="searchBar">
		<textarea rows="1" placeholder="search" class="searchTextArea" id="searchTextarea" required></textarea>
		<button class="searchButton" onclick="search()">search</button>
	</div>
	
	<div class="content">
		
	</div>
	
	% if ($c->session('id')){
		<a href="/logout" > Logout , <%= $user->{first_name}%> </a>
		<p>or</p>
		<a href="/login" > Sign in to another service</a>
	% } else {
	<a href="/login" > Login  </a>
	% }
	
	<div class="showMoreButton" onclick="showMore()">
		show more
	</div>

	<div class="singlePost">
		<div class= "postContainer" id="postContainer_ID">
			<div class="voteInfoContainer" id="voteInfoContainer_ID">
				<div class="upvoteContainer">
					<img class="containedImg" src="/img/smalluparrow.png" alt="uparrow"
					id="upvote_ID"
					onmouseenter="changeVoteImg(ID, 'in', 'up')"
					onmouseleave="changeVoteImg(ID, 'out', 'up')"
					onclick="vote(ID, 'up')">
				</div>
				<div class="voteContainer" id="voteContainer_ID">
					VOTES
				</div>
				<div class="downvoteContainer">
					<img class="containedImg" src="/img/smalldownarrow.png" alt="downarrow"
					id="downvote_ID"
					onmouseenter="changeVoteImg(ID, 'in', 'down')"
					onmouseleave="changeVoteImg(ID, 'out', 'down')"
					onclick="vote(ID, 'down')">
				</div>
			</div>
			
			<div class="buttonContainer" id="buttonContainer_ID">
				<div class="deleteButtonContainer" id="deleteButtonContainer_ID">
					<img class= "containedImg" src="/img/trash.png" alt="delete" 
					onmouseenter="this.src='/img/opentrash.png'" 
					onmouseleave="this.src='/img/trash.png'" onclick="if( ConfirmDelete() == true){deletePost(ID)}"                                      
					type="submit" name="actiondelete" value="1">

				</div>

			</div>
			
			<div class="postTextAndInfoContainer" id="postTextAndInfoContainer_ID">
				<div class="postTextContainer" id="postTextContainer_ID">
					<div class="postText" id="textContainer_ID">
					    TEXT
					</div>
				</div>
				<div class="postInfoContainer">
					<div class="postActionContainer" id="showCommentsButton_ID" onclick="toggleComments(ID)">
						show comments<br>(NUMCOMMENTS)
					</div>
					<div class="postActionContainer" id="replyButton_ID" onclick="toggleReplyForm(ID)">
						reply
					</div>
					<div class="timeAskedContainer" id="timeAskedContainer_ID">
						TIMEASKED
					</div>
				</div>
			</div>
		</div>
		
		<div class="replyContainer" id="replyContainer_ID">
            <label class='newPostTitle' for='comment'>Reply</label>
            <br><textarea class = "newPostTextArea" id="newPostTextArea_ID" placeholder= "Enter reply here"></textarea><br>
            <button class="postButton" onclick="sendReply(ID)">Post</button>
		</div>
			
		<div class="commentsContainer" id="commentsContainer_ID">
		</div>
	</div>
	
	<div class="singleComment">
		<div class="commentContainer" id="commentContainer_ID">
			<div class="commentVoteInfoContainer" id="voteInfoContainer_ID">
				<div class="commentUpvoteContainer">
					<img class="containedImg" src="/img/smalluparrow.png" alt="uparrow"
					id="upvote_ID"
					onmouseenter="changeVoteImg('ID', 'in', 'up')"
					onmouseleave="changeVoteImg('ID', 'out', 'up')"
					onclick="vote('ID', 'up')">
				</div>
				<div class="commentVoteContainer" id="voteContainer_ID">
					VOTES
				</div>
				<div class="commentDownvoteContainer">
					<img class="containedImg" src="/img/smalldownarrow.png" alt="downarrow"
					id="downvote_ID"
					onmouseenter="changeVoteImg('ID', 'in', 'down')"
					onmouseleave="changeVoteImg('ID', 'out', 'down')"
					onclick="vote('ID', 'down')">
				</div>
			</div>
			
			<div class="commentPostTextAndInfoContainer" id="postTextAndInfoContainer_ID">
				<div class="commentPostTextContainer" id="postTextContainer_ID">
					<div class="commentPostText" id="textContainer_ID">
					    TEXT
					</div>
				</div>
					
				<div class="commentPostInfoContainer">
					<div class="commentDeleteButtonContainer" id="deleteButtonContainer_ID">
						<img class= "containedImg" src="/img/trash.png" alt="delete" 
						onmouseenter="this.src='/img/opentrash.png'" 
						onmouseleave="this.src='/img/trash.png'" onclick="if( ConfirmDelete() == true){deletePost('ID')}"
                        type="submit" name="actiondelete" value="1">

					</div>
						
					<div class="commentFlagButtonContainer">
						<img class= "containedImg" src="/img/flag.png" alt="Flag" 
						id="flagImg_ID"
						onmouseenter="changeFlag('ID', 'in')" 
						onmouseleave="changeFlag('ID', 'out')"
						onclick="sendFlagReport('ID')">
					</div>
						
					<div class="commentAnswerButtonContainer" id="answerButtonContainer_ID">
						<img class="containedImg" src="/img/checkmark.png" alt="Checkmark"
						id="answerImg_ID"
						onmouseenter="changeCheckMark('ID', 'in')"
						onmouseleave="changeCheckMark('ID', 'out')"
						onclick="markAnswer('ID')">
					</div>
						
					<div class="commentTimeAskedContainer">
						TIMEASKED
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
